## Начало пути на новой вм положим простую очистку всех правил
```console
iptables -F
```

Для определенной цепочки (К примеру input)

```console
iptables -F Input
```

## Блокировка пакетов

Вот так будет выглядеть команда, которая позволяет добавить правило iptables для блокировки всех входящих пакетов от 10.10.10.10:
```console
iptables -A INPUT -s 10.10.10.10 -j DROP
```
А теперь исходящие пакеты на этот же адрес:
```console
iptables -A OUTPUT -s 10.10.10.10 -j DROP
```
Блокировка диапазона ip выполняется подобным образом. Для этого нужно использовать маску сети 10.10.10.0/24. Это будут все адреса начиная от 10.10.10.0 до 10.10.10.255:
```console
iptables -A INPUT -s 10.10.10.0/24 -j DROP
```

Или расширенный вариант маски:
```console
iptables -A INPUT -s 10.10.10.0/255.255.255.0 -j DROP
```

Также вы можете заблокировать все входящие соединения ssh:
```console
iptables -A INPUT -p tcp --dport ssh -s 10.10.10.10 -j DROP
```

Как видите, добавить правило iptables очень просто.

## Удаление правил
Ранее мы создали правило для блока исходящих пакетов на адрес 10.10.10.10
>iptables -A OUTPUT -s 10.10.10.10 -j DROP

Для его удаление необходимо заменить ключ -A на -D
```console
iptables -D OUTPUT -s 10.10.10.10 -j DROP
```
## Сохранение правил.

Все настройки iptables, которые вы указали с помощью этих команд сохранятся только до перезагрузки. После перезагрузки компьютера все изменения будут стерты. Поэтому чтобы сохранить правила iptables, нужно выполнить специальную команду. Только в разных дистрибутивах она отличается. В Ubuntu выполните:

```console
/sbin/iptables-save
```

А в Red Hat или CentOS:
```console
/sbin/service iptables save
```