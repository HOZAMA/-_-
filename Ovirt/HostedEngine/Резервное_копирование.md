
Резервное копирование Hosted-engine 
==============

Создайте резервную копию Hosted-engine  с помощью команды engine-backup и скопируйте файл резервной копии в отдельное место, чтобы к нему можно было получить доступ в любой момент процесса.
Дополнительные сведения о механизме резервного копирования --режим=параметры резервного копирования см. в разделе Резервное копирование и восстановление Hosted-engine в Руководстве по администрированию.

Процедура
==============

* Войдите в один из автономных узлов ядра и переведите среду в режим глобального обслуживания:

```console
hosted-engine --set-maintenance --mode=global
```

* Войдите в Hosted-engine  и остановите службу ovirt-engine:

```console
systemctl stop ovirt-engine
systemctl disable ovirt-engine
```

Примечание
==============

Хотя остановка запуска ovirt-engine  не является обязательной, это рекомендуется, поскольку это гарантирует, что после создания резервной копии в среду не будут внесены изменения. Кроме того, это не позволяет первоначальному ovirt-engine и новому ovirt-engine одновременно управлять существующими ресурсами.

* Запустите команду engine-backup, указав имя создаваемого файла резервной копии и имя файла журнала, который необходимо создать для хранения журнала резервной копии:

```console
engine-backup --mode=backup --file=file_name --log=log_file_name
```

* Скопируйте файлы на внешний сервер. В следующем примере, storage.example.com это полное доменное имя сетевого сервера хранения, на котором будет храниться резервная копия до тех пор, пока она не понадобится, а /backup/ - любая назначенная папка или путь.

```console
scp -p file_name log_file_name storage.example.com:/backup/
```

* Войдите в один из автономных узлов ядра и завершите работу виртуальной машины Hosted-engine:

```console
hosted-engine --vm-shutdown
```

* После создания резервной копии Диспетчера разверните новый автономный движок и восстановите резервную копию на новой виртуальной машине.
